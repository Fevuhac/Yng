////////////////////////////////////////////////////////////////////////////////
// 入口路由管理
////////////////////////////////////////////////////////////////////////////////

//==============================================================================
// import
//==============================================================================
var express = require('express');
var router = express.Router();
var url = require('url');
var querystring = require("querystring");


//==============================================================================
// const
//==============================================================================
const DEBUG = 0;
const INFO = 1;
const ERROR = 1;

//==============================================================================
// router
//==============================================================================
/* GET. */
router.get('/', function (req, res) {
    _handlePath(req, res);
});

/* POST. */
router.get('/', function (req, res) {
    _handlePath(req, res);
});

module.exports = router;


//==============================================================================
// public
//==============================================================================

//------------------------------------------------------------------------------
// definition
//------------------------------------------------------------------------------

//------------------------------------------------------------------------------
// implement
//------------------------------------------------------------------------------


//==============================================================================
// private
//==============================================================================

function _handlePath(req, res) {
    var myUrl = url.parse(req.url);
    var args = querystring.parse(myUrl.query);
    
    if (DEBUG) console.log("req:", req);
    if (INFO) console.log("req.originalUrl:", req.originalUrl);
    if (INFO) console.log("req.url:", req.url);
    if (INFO) console.log("myUrl:", myUrl);
    if (INFO) console.log("args:", args);
    
    if (args.pf == null) {
        args.pf = "qzone";
    }
    // 注入URL参数
    res.render("index", args);
    //res.render("entry", args);
}