////////////////////////////////////////////////////////////////////////////////
// 客户端获取API服务器的接口实现.
////////////////////////////////////////////////////////////////////////////////

//==============================================================================
// import
//==============================================================================
//------------------------------------------------------------------------------
// 工具(Utils)
//------------------------------------------------------------------------------
var DataUtil = require('../../src/utils/DataUtil');

//------------------------------------------------------------------------------
// 业务(Buzz)
//------------------------------------------------------------------------------
var buzz_client_server = require('../../src/buzz/client/server');

//------------------------------------------------------------------------------
// 缓存(Cache)
//------------------------------------------------------------------------------


//==============================================================================
// const
//==============================================================================
var DEBUG = 0;
var ERROR = 1;

var TAG = "【client/server】";

//==============================================================================
// public
//==============================================================================

//------------------------------------------------------------------------------
// definition
//------------------------------------------------------------------------------
exports.getApiServer = getApiServer;

//------------------------------------------------------------------------------
// implement
//------------------------------------------------------------------------------
/**
 * 获取按策略分配的API服务器地址.
 */
function getApiServer(req, res, is_https) {
    const FUNC = TAG + "getApiServer() --- ";
    const HINT = "获取API服务器地址";
    //----------------------------------
    var aes = req.body.aes;
    var dataObj = DataUtil.parseDataObj(req, FUNC, HINT);

    dataObj.is_https = is_https;
    if(DEBUG)console.log(FUNC + "dataObj:", dataObj);
    
    buzz_client_server.getApiServer(req, dataObj, function (err, result) {
        DataUtil.handleReturn(res, aes, err, result, FUNC, HINT);
    });
}


//==============================================================================
// private
//==============================================================================